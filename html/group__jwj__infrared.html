<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>BLE IR Remote: IR Functions</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">BLE IR Remote
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Bluetooth LE enabled multi-remote controller.</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('group__jwj__infrared.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">IR Functions</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions for sending IR codes.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr class="memitem:ga42ad2dbdd6cb97ef1a3ca646eb153728"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jwj__infrared.html#ga42ad2dbdd6cb97ef1a3ca646eb153728">IR_HIGH</a>&#160;&#160;&#160;TCCR0A |= (1&lt;&lt; COM0B1)</td></tr>
<tr class="memitem:ga7c235b14736eef26dd8cec5c274c08dc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jwj__infrared.html#ga7c235b14736eef26dd8cec5c274c08dc">IR_LOW</a>&#160;&#160;&#160;TCCR0A &amp;= ~(1&lt;&lt; COM0B1)</td></tr>
<tr class="memitem:ga51bb812ee93ec161c09b1e8fcddf0e4d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jwj__infrared.html#ga51bb812ee93ec161c09b1e8fcddf0e4d">OCR0A_VALUE</a>&#160;&#160;&#160;53</td></tr>
<tr class="memitem:gab7919e01e1cfe27c93b51917d1501978"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jwj__infrared.html#gab7919e01e1cfe27c93b51917d1501978">OCR0B_VALUE</a>&#160;&#160;&#160;18</td></tr>
<tr class="memitem:gaa9fe7ae368a06503001c4e9303cb93c9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jwj__infrared.html#gaa9fe7ae368a06503001c4e9303cb93c9">PRESCALER_FLAGS</a>&#160;&#160;&#160;(1&lt;&lt; CS01)</td></tr>
<tr class="memitem:ga26f53b7361e8f4529b048dfa1237908a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jwj__infrared.html#ga26f53b7361e8f4529b048dfa1237908a">TRIM</a>&#160;&#160;&#160;500</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa6e4c3e75b86ccd24c9e815d7dd53cfb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jwj__infrared.html#gaa6e4c3e75b86ccd24c9e815d7dd53cfb">sendPulseD</a> (double highTime, double lowTime)</td></tr>
<tr class="memitem:ga0f861d99f6a01ff6d011c30dd8e15787"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jwj__infrared.html#ga0f861d99f6a01ff6d011c30dd8e15787">sendPulse</a> (uint8_t highTime, uint8_t lowTime)</td></tr>
<tr class="memitem:ga607d10b247d3ef3957a029dff92cca1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jwj__infrared.html#ga607d10b247d3ef3957a029dff92cca1e">sendNECByte</a> (uint8_t data)</td></tr>
<tr class="memitem:gaa93d02f9f48cf317a4d2d9410a240c9f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jwj__infrared.html#gaa93d02f9f48cf317a4d2d9410a240c9f">sendNECCommand</a> (uint8_t data)</td></tr>
<tr class="memitem:ga3ef44fa7f9e2694386cefa711bbefa96"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jwj__infrared.html#ga3ef44fa7f9e2694386cefa711bbefa96">sendSequence</a> (unsigned char *data)</td></tr>
<tr class="memitem:ga3fc8699debb6da1fce7cc7c1043484c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jwj__infrared.html#ga3fc8699debb6da1fce7cc7c1043484c4">initIR</a> ()</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #include &quot;infrared.h&quot;</span> 
</pre></div><p>IR Functions</p>
<p>These functions send the IR codes as sequences of on-off pulses.</p>
<p>Timer0 is used to generate a 38 kHz PWM signal with a duty cycle of 1/3 on the OC0B (PD5) pin.</p>
<p>Calculate the correct OCR0A and prescaler values at <a href="http://www.et06.dk/atmega_timers/">http://www.et06.dk/atmega_timers/</a>. </p>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="group__jwj__infrared.html#ga51bb812ee93ec161c09b1e8fcddf0e4d">OCR0A_VALUE</a> </dd>
<dd>
<a class="el" href="group__jwj__infrared.html#gab7919e01e1cfe27c93b51917d1501978">OCR0B_VALUE</a></dd></dl>
<dl class="section author"><dt>Author:</dt><dd>Jens Willy Johannsen <a href="#" onclick="location.href='mai'+'lto:'+'jen'+'s@'+'jen'+'sw'+'ill'+'y.'+'dk'; return false;">jens@<span style="display: none;">.nosp@m.</span>jens<span style="display: none;">.nosp@m.</span>willy<span style="display: none;">.nosp@m.</span>.dk</a> <a href="http://atomslagstyrken.dk/arduino">http://atomslagstyrken.dk/arduino</a> </dd></dl>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ga42ad2dbdd6cb97ef1a3ca646eb153728"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="group__jwj__infrared.html#ga42ad2dbdd6cb97ef1a3ca646eb153728">IR_HIGH</a>&#160;&#160;&#160;TCCR0A |= (1&lt;&lt; COM0B1)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Macros for switching PWM output on – i.e. setting the IR pulse <em>high</em>. </p>

</div>
</div>
<a class="anchor" id="ga7c235b14736eef26dd8cec5c274c08dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="group__jwj__infrared.html#ga7c235b14736eef26dd8cec5c274c08dc">IR_LOW</a>&#160;&#160;&#160;TCCR0A &amp;= ~(1&lt;&lt; COM0B1)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Macros for switching PWM output off – i.e. setting the IR pulse <em>low</em>. </p>

</div>
</div>
<a class="anchor" id="ga51bb812ee93ec161c09b1e8fcddf0e4d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="group__jwj__infrared.html#ga51bb812ee93ec161c09b1e8fcddf0e4d">OCR0A_VALUE</a>&#160;&#160;&#160;53</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets the TOP value for the 8 bit Timer0 for a PWM frequency of 38 kHz (or as close as possible. Values can be calculated here: <a href="http://www.et06.dk/atmega_timers/">http://www.et06.dk/atmega_timers/</a> </p>

</div>
</div>
<a class="anchor" id="gab7919e01e1cfe27c93b51917d1501978"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="group__jwj__infrared.html#gab7919e01e1cfe27c93b51917d1501978">OCR0B_VALUE</a>&#160;&#160;&#160;18</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets the OCR value for duty cycle. This should be about 1/3 of the OCR0A value. </p>

</div>
</div>
<a class="anchor" id="gaa9fe7ae368a06503001c4e9303cb93c9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="group__jwj__infrared.html#gaa9fe7ae368a06503001c4e9303cb93c9">PRESCALER_FLAGS</a>&#160;&#160;&#160;(1&lt;&lt; CS01)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Define the prescaler flags to match the OCR0A value for a PWM frequency of 38 kHz. Values can be calculated here: <a href="http://www.et06.dk/atmega_timers/">http://www.et06.dk/atmega_timers/</a> </p>

</div>
</div>
<a class="anchor" id="ga26f53b7361e8f4529b048dfa1237908a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="group__jwj__infrared.html#ga26f53b7361e8f4529b048dfa1237908a">TRIM</a>&#160;&#160;&#160;500</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The trim value is a number that is <em>subtracted</em> from the specified time durations in order to compensate for the extra CPU cycles used in control loops etc. This value is really best determined by measuring the on/off times on an oscilloscope and adjusting the value (higher values = shorter durations) until the measured duration matches the specified duration. Nominally, the value is in microseconds. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga3fc8699debb6da1fce7cc7c1043484c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__jwj__infrared.html#ga3fc8699debb6da1fce7cc7c1043484c4">initIR</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initializes Timer0 for 38 kHz PWM. </p>
<dl class="section note"><dt>Note:</dt><dd>Pin OC0B (PD5) is configured as output and used for the PWM signal. </dd></dl>

</div>
</div>
<a class="anchor" id="ga607d10b247d3ef3957a029dff92cca1e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__jwj__infrared.html#ga607d10b247d3ef3957a029dff92cca1e">sendNECByte</a> </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sends a NEC1 byte.  </p>

</div>
</div>
<a class="anchor" id="gaa93d02f9f48cf317a4d2d9410a240c9f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__jwj__infrared.html#gaa93d02f9f48cf317a4d2d9410a240c9f">sendNECCommand</a> </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sends a NEC1 command byte.</p>
<p>Sends the byte followed by the inverted byte.  </p>

</div>
</div>
<a class="anchor" id="ga0f861d99f6a01ff6d011c30dd8e15787"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__jwj__infrared.html#ga0f861d99f6a01ff6d011c30dd8e15787">sendPulse</a> </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>highTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>lowTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sends an on-off pulse. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">highTime</td><td>Time in 100 µs for the <em>ON</em> part of the pulse. </td></tr>
    <tr><td class="paramname">lowTime</td><td>Time in 100 µs for the <em>OFF</em> part of the pulse.</td></tr>
  </table>
  </dd>
</dl>
<p>This method uses byte integer parameters for the time specification. The times are in 100 µs. Thus, a value of 16 will translate to 1.6 ms. Maximum duration for either on or off is 25.5 ms.</p>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="group__jwj__infrared.html#gaa6e4c3e75b86ccd24c9e815d7dd53cfb">sendPulseD</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gaa6e4c3e75b86ccd24c9e815d7dd53cfb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__jwj__infrared.html#gaa6e4c3e75b86ccd24c9e815d7dd53cfb">sendPulseD</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>highTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lowTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sends an on-off pulse. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">highTime</td><td>Time in milliseconds for the <em>ON</em> part of the pulse. </td></tr>
    <tr><td class="paramname">lowTime</td><td>Time in milliseconds for the <em>OFF</em> part of the pulse.</td></tr>
  </table>
  </dd>
</dl>
<p>This method uses <code>double</code> parameters for the time specification. </p>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="group__jwj__infrared.html#ga0f861d99f6a01ff6d011c30dd8e15787">sendPulse</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga3ef44fa7f9e2694386cefa711bbefa96"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__jwj__infrared.html#ga3ef44fa7f9e2694386cefa711bbefa96">sendSequence</a> </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sends a IR pulse sequence</p>
<p>The IR data passed in the <code>data</code> parameter must consist of an array of byte pairs terminated by 0x00. The first byte is ON time in 0.1 ms and the second byte is the OFF time in 0.1 ms.</p>
<p>Since the array consists of byte pairs terminated by a single 0x00 byte, the length will be an uneven number (although an extra 0x00 will make no difference).</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>A pointer to a 0x00 terminated array of byte pairs consisting of ON and OFF time values in 0.1 ms. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="group__jwj__infrared.html#ga26f53b7361e8f4529b048dfa1237908a">TRIM</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>

    <li class="footer">Generated on Mon May 7 2012 23:18:31 for BLE IR Remote by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.0 </li>
   </ul>
 </div>


</body>
</html>
